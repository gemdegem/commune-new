"use strict";(()=>{var e={};e.id=181,e.ids=[181],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1017:e=>{e.exports=require("path")},7310:e=>{e.exports=require("url")},3394:(e,n,r)=>{r.r(n),r.d(n,{GlobalError:()=>a.a,__next_app__:()=>m,originalPathname:()=>h,pages:()=>c,routeModule:()=>u,tree:()=>i});var o=r(7096),s=r(6132),t=r(7284),a=r.n(t),d=r(2564),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);r.d(n,l);let i=["",{children:["docs",{children:["modules",{children:["model-hf",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,711)),"/Users/bartek/Downloads/Programowanie/Commune-fresh/frontend/src/app/docs/modules/model-hf/page.mdx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,7941)),"/Users/bartek/Downloads/Programowanie/Commune-fresh/frontend/src/app/docs/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,563))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,4959)),"/Users/bartek/Downloads/Programowanie/Commune-fresh/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,563))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/bartek/Downloads/Programowanie/Commune-fresh/frontend/src/app/docs/modules/model-hf/page.mdx"],h="/docs/modules/model-hf/page",m={require:r,loadChunk:()=>Promise.resolve()},u=new o.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/docs/modules/model-hf/page",pathname:"/docs/modules/model-hf",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:i}})},711:(e,n,r)=>{r.r(n),r.d(n,{default:()=>MDXContent});var o=r(1837),s=r(818);function _createMdxContent(e){let n={code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[o.jsx(n.hr,{}),"\n",o.jsx(n.h2,{children:"id: model-hf\ntitle: Model Transformer\nsidebar_position: 3\nslug: /model-hf\nsidebar_label: Model Transformer"}),"\n",o.jsx(n.h1,{children:"Model.Transformer"}),"\n",o.jsx(n.p,{children:"This module involves wrapping over the huggingface transformers library. It will allow you to deploy any model in hugginface."}),"\n",o.jsx(n.h2,{children:"Serving"}),"\n",o.jsx(n.pre,{children:o.jsx(n.code,{className:"language-bash",children:"c model.transformer serve tag=10 model=vicuna.7b\n"})}),"\n",o.jsx(n.pre,{children:o.jsx(n.code,{className:"language-python",children:"import commune as c\nc.serve('model.hf', tag=10, model='vicuna.7b')\n"})}),"\n",o.jsx(n.p,{children:"We use shortcuts when calling models, so for instance vicuna.7b refers to lmsys/vicuna-7b-v1.3. To add a shortcut, go into the config and add the shortcut."}),"\n",o.jsx(n.p,{children:"At the moment, serving the model.transformer has a default name of model.{moodelname}, which in this case is."}),"\n",o.jsx(n.pre,{children:o.jsx(n.code,{children:"model.vicuna.7b\n"})}),"\n",o.jsx(n.p,{children:"We did this by overriding the def serve in the model.transformers module to have a more custom serve. Check it out through"}),"\n",o.jsx(n.pre,{children:o.jsx(n.code,{className:"language-python",children:"c.module('model.trasnformer').fn_code('serve')\n"})}),"\n",o.jsx(n.h3,{children:"GPU ALLOCATION"}),"\n",(0,o.jsxs)(n.p,{children:["Commune will find the most avaiable gpus and allocate the model to the least used one. This is done through ",o.jsx(n.code,{children:"c.infer_device_map(model)"}),". You can also setup the layers on specific gpus with the decive_map (default to 'auto')"]}),"\n",o.jsx(n.pre,{children:o.jsx(n.code,{className:"language-yaml",children:"shortcuts:\n  vicuna.7b: lmsys/vicuna-7b-v1.3\n"})}),"\n",o.jsx(n.h2,{children:"Register on Commune"}),"\n",o.jsx(n.p,{children:"To register the module"}),"\n",o.jsx(n.pre,{children:o.jsx(n.code,{className:"language-bash",children:"c model.transformer register tag=10 model=vicuna.7b\n"})}),"\n",o.jsx(n.pre,{children:o.jsx(n.code,{className:"language-python",children:"import commune as c\nc.register('model.hf', tag=10, model=vicuna.7b)\n"})}),"\n",o.jsx(n.h2,{children:"Calling it"}),"\n",o.jsx(n.p,{children:"c.connect('model.vicuna7b')"})]})}function MDXContent(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?o.jsx(n,{...e,children:o.jsx(_createMdxContent,{...e})}):_createMdxContent(e)}}};var n=require("../../../../webpack-runtime.js");n.C(e);var __webpack_exec__=e=>n(n.s=e),r=n.X(0,[975,323,837,429,603,333],()=>__webpack_exec__(3394));module.exports=r})();